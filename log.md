diff --git a/src/App.css b/src/App.css index 650e423..a207f75 100644 --- a/src/App.css +++ b/src/App.css @@ -1,25 +1,38 @@ :root { - background-color: #000; - --color-text: #fff; + background-color: #1a1a1a; + --color-primary: #ff6b6b; + --color-secondary: #4ecdc4; + --color-text: #ffffff; + --color-background: #2d2d2d; + --color-border: #444444; } +/* Background Animation dist/ node_modules/ src/ .Background { position: fixed; background: radial-gradient( - 71.43% 62.3% at 46.43% 36.43%, - rgba(18, 229, 229, 0) 15%, - rgba(239, 155, 255, 0.3) 56.35%, - #ff6448 100% + circle at 50% 50%, + rgba(255, 107, 107, 0.2), + rgba(78, 205, 196, 0.2), + rgba(45, 45, 45, 1) ); - box-shadow: 0px 12.93px 28.74px 0px #ffd28db2 inset; - border-radius: 50%; width: 200vw; - height: 200vw; - top: -60vw; - left: -14.27vw; - transform: rotate(15.25deg); + height: 200vh; + top: -50vh; + left: -50vw; + animation: rotateBackground 20s linear infinite; } +@keyframes rotateBackground { + from { + transform: rotate(0deg); + } + to { + transform: rotate(360deg); + } +} + +/* App Container dist/ node_modules/ src/ .App { position: relative; min-height: 100vh; @@ -27,12 +40,11 @@ flex-direction: column; align-items: center; justify-content: center; -} - -text { + padding: 20px; color: var(--color-text); } +/* Banner dist/ node_modules/ src/ .Banner { flex: 5; display: flex; @@ -49,16 +61,15 @@ text { margin-bottom: 8px; } -.Logo--react { +.Logo--static { width: 100px; height: 100px; - animation: Logo--spin infinite 20s linear; } -.Logo--lynx { +.Logo--spin { width: 100px; height: 100px; - animation: Logo--shake infinite 0.5s ease; + animation: Logo--spin infinite 2s linear; } @keyframes Logo--spin { @@ -70,30 +81,6 @@ text { } } -@keyframes Logo--shake { - 0% { - transform: scale(1); - } - 50% { - transform: scale(0.9); - } - 100% { - transform: scale(1); - } -} - -.Content { - display: flex; - flex-direction: column; - align-items: center; - justify-content: center; -} - -.Arrow { - width: 24px; - height: 24px; -} - .Title { font-size: 36px; font-weight: 700; @@ -106,6 +93,14 @@ text { margin-bottom: 8px; } +/* Content dist/ node_modules/ src/ +.Content { + display: flex; + flex-direction: column; + align-items: center; + justify-content: center; +} + .Description { font-size: 20px; color: rgba(255, 255, 255, 0.85); diff --git a/src/App.tsx b/src/App.tsx index 3b6301b..d16b84f 100644 --- a/src/App.tsx +++ b/src/App.tsx @@ -1,23 +1,19 @@ -import { useCallback, useEffect, useState } from '@lynx-js/react' +import { useCallback, useEffect, useState } from '@lynx-js/react'; +import './App.css'; +import lynxLogo from './assets/lynx-logo.png'; +import { useNavigate } from 'react-router'; -import './App.css' -import arrow from './assets/arrow.png' -import lynxLogo from './assets/lynx-logo.png' -import reactLynxLogo from './assets/react-logo.png' -import { useNavigate } from 'react-router' - -export function App() { - const [alterLogo, setAlterLogo] = useState(false) - const nav = useNavigate(); +export default function App() { + const [alterLogo, setAlterLogo] = useState(false); + const navigate = useNavigate(); useEffect(() => { - console.info('Hello, ReactLynx') - }, []) + console.info('Welcome to Mini Social!'); + }, []); const onTap = useCallback(() => { - 'background only' - setAlterLogo(!alterLogo) - }, [alterLogo]) + setAlterLogo(!alterLogo); + }, [alterLogo]); return ( <view> @@ -25,26 +21,23 @@ export function App() { <view className='App'> <view className='Banner'> <view className='Logo' bindtap={onTap}> - {alterLogo - ? <image src={reactLynxLogo} className='Logo--react' /> - : <image src={lynxLogo} className='Logo--lynx' />} + <image src={lynxLogo} className={alterLogo ? 'Logo--spin' : 'Logo--static'} /> </view> - <text className='Title'>React</text> - <text className='Subtitle'>on Lynx</text> + <text className='Title'>Mini Social</text> + <text className='Subtitle'>Connect with the world</text> </view> <view> - <text bindtap={() => nav('/home')}>go home</text> + <text bindtap={() => navigate('/login')}>Login</text> </view> <view className='Content'> - <image src={arrow} className='Arrow' /> - <text className='Description'>Tap the logo and have fun!</text> + <text className='Description'>Tap the logo to see magic!</text> <text className='Hint'> Edit<text style={{ fontStyle: 'italic' }}>{' src/App.tsx '}</text> - to see updates! + to customize this app. </text> </view> <view style={{ flex: 1 }}></view> </view> </view> - ) + ); } diff --git a/src/components/ProtectedRoute.tsx b/src/components/ProtectedRoute.tsx new file mode 100644 index 0000000..b5a3759 --- /dev/null +++ b/src/components/ProtectedRoute.tsx @@ -0,0 +1,22 @@ +import { useEffect } from '@lynx-js/react'; +import { useNavigate } from 'react-router'; +import { getItem } from '../utils/storage'; + +const ProtectedRoute = ({ children }) => { + const navigate = useNavigate(); + + useEffect(() => { + const checkAuth = async () => { + const token = await getItem('accessToken'); + if (!token) { + navigate('/login'); // Redirect to login if not authenticated + } + }; + + checkAuth(); + }, [navigate]); + + return children; +}; + +export default ProtectedRoute; diff --git a/src/index.tsx b/src/index.tsx index 54e573e..1003489 100644 --- a/src/index.tsx +++ b/src/index.tsx @@ -1,18 +1,36 @@ -import { root } from '@lynx-js/react' - -import { App } from './App.tsx' -import { MemoryRouter, Route, Routes } from 'react-router' -import Home from './screens/Home.tsx' +import { root } from '@lynx-js/react'; +import { MemoryRouter, Route, Routes } from 'react-router'; +import App from './App.tsx'; +import Home from './screens/Home.tsx'; +import Login from './screens/Login.tsx'; +import Posts from './screens/Posts.tsx'; +import ProtectedRoute from './components/ProtectedRoute.tsx'; root.render( <MemoryRouter> <Routes> - <Route path='/' element={<App />} /> - <Route path='/home' element={<Home />} /> + <Route path="/" element={<App />} /> + <Route path="/login" element={<Login />} /> + <Route + path="/home" + element={ + <ProtectedRoute> + <Home /> + </ProtectedRoute> + } + /> + <Route + path="/posts" + element={ + <ProtectedRoute> + <Posts /> + </ProtectedRoute> + } + /> </Routes> </MemoryRouter> -) +); if (import.meta.webpackHot) { - import.meta.webpackHot.accept() + import.meta.webpackHot.accept(); } diff --git a/src/screens/Login.tsx b/src/screens/Login.tsx new file mode 100644 index 0000000..97ff549 --- /dev/null +++ b/src/screens/Login.tsx @@ -0,0 +1,36 @@ +import { useState } from '@lynx-js/react'; +import { useNavigate } from 'react-router'; +import useAuthStore from '../store/authStore'; + +const Login = () => { + const [email, setEmail] = useState(''); + const [password, setPassword] = useState(''); + const navigate = useNavigate(); + const { login } = useAuthStore(); + + const handleLogin = async () => { + await login(email, password); + navigate('/home'); // Redirect to home after login + }; + + return ( + <view className="Login"> + <text style={{ fontSize: 24, fontWeight: 'bold', marginBottom: 20 }}>Login</text> + <input + type="email" + placeholder="Email" + value={email} + onChange={(e) => setEmail(e.target.value)} + /> + <input + type="password" + placeholder="Password" + value={password} + onChange={(e) => setPassword(e.target.value)} + /> + <button bindtap={handleLogin}>Login</button> + </view> + ); +}; + +export default Login; diff --git a/src/screens/Posts.tsx b/src/screens/Posts.tsx new file mode 100644 index 0000000..3104bb7 --- /dev/null +++ b/src/screens/Posts.tsx @@ -0,0 +1,32 @@ +import { useEffect, useState } from '@lynx-js/react'; +import fetchWithAuth from '../utils/api'; + +const Posts = () => { + const [posts, setPosts] = useState([]); + + useEffect(() => { + const fetchPosts = async () => { + try { + const response = await fetchWithAuth('/posts'); + setPosts(response); + } catch (error) { + console.error('Failed to fetch posts:', error); + } + }; + + fetchPosts(); + }, []); + + return ( + <view className="Posts"> + <text style={{ fontSize: 24, fontWeight: 'bold', marginBottom: 20 }}>Posts</text> + {posts.map((post) => ( + <view className="Post" key={post.id}> + <text>{post.content}</text> + </view> + ))} + </view> + ); +}; + +export default Posts; diff --git a/src/store/authStore.ts b/src/store/authStore.ts new file mode 100644 index 0000000..573bb16 --- /dev/null +++ b/src/store/authStore.ts @@ -0,0 +1,43 @@ +import { useState } from '@lynx-js/react'; +import fetchWithAuth from '../utils/api'; +import { setItem, getItem, removeItem } from '../utils/storage'; + +const useAuthStore = () => { + const [user, setUser] = useState(null); + const [isAuthenticated, setIsAuthenticated] = useState(false); + + const login = async (email: string, password: string) => { + try { + const response = await fetchWithAuth('/auth/login', { + method: 'POST', + headers: { + 'Content-Type': 'application/json', + }, + body: JSON.stringify({ email, password }), + }); + await setItem('accessToken', response.accessToken); // Use native storage + setUser(response.user); + setIsAuthenticated(true); + } catch (error) { + console.error('Login failed:', error); + } + }; + + const logout = async () => { + await removeItem('accessToken'); // Use native storage + setUser(null); + setIsAuthenticated(false); + }; + + // Check if the user is already authenticated on app load + const checkAuth = async () => { + const token = await getItem('accessToken'); // Use native storage + if (token) { + setIsAuthenticated(true); + } + }; + + return { user, isAuthenticated, login, logout, checkAuth }; +}; + +export default useAuthStore; diff --git a/src/utils/api.ts b/src/utils/api.ts new file mode 100644 index 0000000..47a05c4 --- /dev/null +++ b/src/utils/api.ts @@ -0,0 +1,22 @@ +const API_BASE_URL = 'http://localhost:3000'; // Replace with your NestJS backend URL + +const fetchWithAuth = async (url: string, options: RequestInit = {}) => { + const token = await getItem('accessToken'); // Use native storage + const headers = { + ...options.headers, + Authorization: `Bearer ${token}`, + }; + + const response = await fetch(`${API_BASE_URL}${url}`, { + ...options, + headers, + }); + + if (!response.ok) { + throw new Error(`HTTP error! Status: ${response.status}`); + } + + return response.json(); +}; + +export default fetchWithAuth; diff --git a/src/utils/storage.ts b/src/utils/storage.ts new file mode 100644 index 0000000..73fb020 --- /dev/null +++ b/src/utils/storage.ts @@ -0,0 +1,16 @@ +// Use Lynx's LocalPersistentStorage module +const storage = { + setItem: async (key: string, value: string) => { + await LocalPersistentStorage.setItem(key, value); + }, + getItem: async (key: string) => { + return await LocalPersistentStorage.getItem(key); + }, + removeItem: async (key: string) => { + await LocalPersistentStorage.removeItem(key); + }, +}; + +export const setItem = storage.setItem; +export const getItem = storage.getItem; +export const removeItem = storage.removeItem;
